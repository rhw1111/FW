(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75f041a0"],{"3d36":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail"},[s("lookUp",{ref:"SlaveHostHostlookUp",attrs:{masterHostList:t.masterHostList,masterSelectIndex:t.SlaveHostHostIndex,fixed:t.SlaveHostFixed},on:{addMasterHost:t.addSlaveHostHost,cancelMasterHost:t.cancelSlaveHostHost}}),s("div",{staticClass:"detail_header"},[s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"保 存",disable:1==t.isNoRun},on:{click:t.putTestCase}}),s("q-btn",{staticClass:"btn",staticStyle:{background:"#FF0000",color:"white"},attrs:{label:"删 除",disable:1==t.isNoRun},on:{click:t.deleteTestCase}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"运 行",disable:1==t.isNoRun},on:{click:t.run}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"停 止",disable:1!=t.isNoRun},on:{click:t.stop}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"查 看 状 态"},on:{click:t.lookStatus}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"查 看 主 机 日 志"},on:{click:t.lookMasterLog}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"查 看 从 主 机 日 志"},on:{click:t.lookSlaveLog}}),s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"性 能 监 测"},on:{click:t.lookMonitorUrl}})],1),s("div",{staticClass:"q-pa-md"},[s("CreateShowTestCase",{ref:"CSTestCase",attrs:{masterHostList:t.masterHostList,dataSourceName:t.dataSourceName,detailData:t.detailData}})],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.createFixed,callback:function(e){t.createFixed=e},expression:"createFixed"}},[s("q-card",{staticStyle:{width:"100%","max-width":"60vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v("创建从主机")])]),s("q-separator"),s("div",{staticClass:"new_input"},[s("div",{staticClass:"row input_row"},[s("q-input",{staticClass:"col",attrs:{dense:!1},scopedSlots:t._u([{key:"before",fn:function(){return[s("span",{staticStyle:{"font-size":"14px"}},[t._v("从主机名称:")])]},proxy:!0}]),model:{value:t.SlaveHostName,callback:function(e){t.SlaveHostName=e},expression:"SlaveHostName"}}),s("q-input",{staticClass:"col",attrs:{dense:!1,placeholder:"副本数"},on:{keyup:function(e){t.SlaveCount=t.SlaveCount.replace(/[^\d]/g,"")}},scopedSlots:t._u([{key:"before",fn:function(){return[s("span",{staticStyle:{"font-size":"14px"}},[t._v("数量:")])]},proxy:!0}]),model:{value:t.SlaveCount,callback:function(e){t.SlaveCount=e},expression:"SlaveCount"}}),s("q-input",{staticClass:"col",attrs:{dense:!1,readonly:"",placeholder:"点击右侧加号选择主机"},scopedSlots:t._u([{key:"before",fn:function(){return[s("span",{staticStyle:{"font-size":"14px"}},[t._v("主机:")])]},proxy:!0},{key:"append",fn:function(){return[s("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"add"},on:{click:t.dblSlaveHostHost}})]},proxy:!0}]),model:{value:t.SlaveHostHostSelect,callback:function(e){t.SlaveHostHostSelect=e},expression:"SlaveHostHostSelect"}})],1),s("div",{staticClass:"row input_row"},[s("q-input",{staticClass:"col",attrs:{dense:!1,type:"textarea",outlined:""},scopedSlots:t._u([{key:"before",fn:function(){return[s("span",{staticStyle:{"font-size":"14px"}},[t._v("扩展信息:")])]},proxy:!0}]),model:{value:t.SlaveExtensionInfo,callback:function(e){t.SlaveExtensionInfo=e},expression:"SlaveExtensionInfo"}})],1)]),s("q-separator"),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{attrs:{flat:"",label:"取消",color:"primary"},on:{click:t.newCancel}}),s("q-btn",{attrs:{flat:"",label:"创建",color:"primary"},on:{click:t.newCreate}})],1)],1)],1),s("div",{staticClass:"q-pa-md row HostList"},[s("q-list",{staticClass:"col-xs-12 col-sm-7 col-xl-7",attrs:{bordered:""}},[s("q-table",{attrs:{title:"从主机列表",data:t.SlaveHostList,columns:t.columns,"row-key":"id",selection:"multiple",selected:t.SlaveHostSelected,"table-style":"max-height: 500px","rows-per-page-options":[0],"no-data-label":"暂无数据更新"},on:{"update:selected":function(e){t.SlaveHostSelected=e}},scopedSlots:t._u([{key:"body-cell-id",fn:function(e){return[s("q-td",{attrs:{props:e}},[s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"更 新",disable:1==t.isNoRun},on:{click:function(s){return t.toSlaveHostDetail(e)}}})],1)]}},{key:"top-right",fn:function(){return[s("q-btn",{staticClass:"\n               btn",attrs:{color:"primary",label:"新 增",disable:1==t.isNoRun},on:{click:t.openSlaveHost}}),s("q-btn",{staticClass:"btn",staticStyle:{background:"#FF0000",color:"white"},attrs:{label:"删 除",disable:1==t.isNoRun},on:{click:t.deleteSlaveHost}})]},proxy:!0},{key:"bottom",fn:function(){},proxy:!0}])})],1),s("History",{ref:"TestCaseHistory",attrs:{isNoRun:t.isNoRun,detailData:t.detailData}})],1)],1)},a=[],i=(s("99af"),s("a9e3"),s("365c")),n=s("7729"),l=s("10b4"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-list",{staticClass:"col-xs-12 col-sm-5 col-xl-5",attrs:{bordered:""}},[s("q-table",{attrs:{title:"历史记录列表",data:t.HistoryList,columns:t.HistoryColumns,"row-key":"id",selection:"multiple",selected:t.HistorySelected,"rows-per-page-options":[0],"table-style":"max-height: 500px","no-data-label":"暂无数据更新"},on:{"update:selected":function(e){t.HistorySelected=e}},scopedSlots:t._u([{key:"top-right",fn:function(){return[s("q-btn",{staticClass:"btn",staticStyle:{background:"#FF0000",color:"white"},attrs:{label:"删 除",disable:1==t.isNoRun},on:{click:t.deleteHistory}})]},proxy:!0},{key:"body-cell-id",fn:function(e){return[s("q-td",{attrs:{props:e}},[s("q-btn",{staticClass:"btn",attrs:{color:"primary",label:"查 看",disable:1==t.isNoRun},on:{click:function(s){return t.toHistoryDetail(e)}}})],1)]}},{key:"bottom",fn:function(){return[s("q-pagination",{staticClass:"col offset-md-8",attrs:{max:t.pagination.rowsNumber,input:!0},on:{input:t.switchPage},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}})]},proxy:!0}])})],1)},c=[],d={name:"History",props:["isNoRun","detailData"],data:function(){return{createFixed:!0,HistoryList:[],HistorySelected:[],HistoryColumns:[{name:"createTime",required:!0,label:"创建时间",align:"left",field:function(t){return t.createTime},format:function(t){return"".concat(t)}},{name:"id",label:"操作",align:"right",field:"id",headerStyle:"text-align:center"}],pagination:{page:1,rowsNumber:1}}},methods:{getHistoryList:function(t){var e=this,s={caseId:this.$route.query.id,page:t||1,pageSize:50};i["m"](s).then((function(s){console.log(s),e.pagination.page=t||1,e.pagination.rowsNumber=Math.ceil(s.data.totalCount/50),e.HistoryList=s.data.results,e.HistorySelected=[],e.$q.loading.hide()}))},deleteHistory:function(){var t=this;0!=this.HistorySelected.length?this.$q.dialog({title:"提示",message:"您确定要删除当前选择的历史记录吗",persistent:!0,ok:{push:!0,label:"确定"},cancel:{push:!0,label:"取消"}}).onOk((function(){if(t.$q.loading.show(),1==t.HistorySelected.length){var e="?caseId=".concat(t.detailData.id,"&historyId=").concat(t.HistorySelected[0].id);i["a"](e).then((function(){t.HistorySelected=[],t.getHistoryList()}))}else if(t.HistorySelected.length>1){for(var s=[],o=0;o<t.HistorySelected.length;o++)s.push(t.HistorySelected[o].id);console.log(s);var a={CaseID:t.detailData.id,IDS:s};i["b"](a).then((function(){t.HistorySelected=[],t.getHistoryList()}))}})):this.$q.notify({position:"top",message:"提示",caption:"请选择历史记录",color:"red"})},switchPage:function(t){this.$q.loading.show(),this.getHistoryList(t)},toHistoryDetail:function(t){this.$router.push({name:"HistoryDetail",query:{historyId:t.row.id,caseId:t.row.caseID}})}}},u=d,h=s("2877"),f=Object(h["a"])(u,r,c,!1,null,"7ca9605e",null),p=f.exports,S={name:"TestCaseDetail",components:{lookUp:n["a"],CreateShowTestCase:l["a"],History:p},data:function(){return{createFixed:!1,isNoRun:0,timerOut:null,detailData:"",data:[{name:"2020/6/20Test",EngineType:"1"},{name:"2020/6/21Test",EngineType:"2"},{name:"2020/6/22Test",EngineType:"3"}],masterHostList:[],dataSourceName:[],SlaveHostFixed:!1,SlaveHostName:"",SlaveCount:"",SlaveExtensionInfo:"",SlaveHostHostId:"",SlaveHostHostSelect:"",SlaveHostHostIndex:-1,SlaveHostList:[],SlaveHostSelected:[],columns:[{name:"slaveName",required:!0,label:"名称",align:"left",field:function(t){return t.slaveName},format:function(t){return"".concat(t)}},{name:"address",align:"left",label:"ip",field:"address"},{name:"count",align:"left",label:"数量",field:"count"},{name:"extensionInfo",label:"扩展信息",align:"left",field:"extensionInfo",style:"width:100px;"},{name:"id",label:"操作",align:"right",field:"id",headerStyle:"text-align:center"}]}},mounted:function(){var t=this;this.getTestCaseDetail(),this.timerOut=window.setInterval((function(){setTimeout(t.getTestCaseStatus(),0)}),3e3)},beforeDestroy:function(){clearInterval(this.timerOut),this.timerOut=null},methods:{getTestCaseDetail:function(){var t=this;this.$q.loading.show(),i["u"]({id:this.$route.query.id}).then((function(e){console.log(e),t.detailData=e.data,t.getMasterHostList(),t.getSlaveHostsList(),t.getTestCaseStatus(),t.getDataSourceName(),t.$refs.TestCaseHistory.getHistoryList()}))},getSlaveHostsList:function(){var t=this;i["s"]({caseId:this.$route.query.id}).then((function(e){console.log(e),t.SlaveHostList=e.data,t.SlaveHostSelected=[],t.$q.loading.hide()}))},getMasterHostList:function(){var t=this;i["n"]().then((function(e){console.log(e),t.masterHostList=e.data;for(var s=0;s<e.data.length;s++)if(e.data[s].id==t.detailData.masterHostID){t.masterSelectIndex=s;break}t.$q.loading.hide()}))},getDataSourceName:function(){var t=this,e={};i["k"](e).then((function(e){console.log(e),t.dataSourceName=e.data}))},getTestCaseStatus:function(){var t=this;i["w"]({caseId:this.$route.query.id}).then((function(e){t.isNoRun=e.data}))},dblSlaveHostHost:function(){this.createFixed=!1,this.SlaveHostFixed=!0},addSlaveHostHost:function(t){if(void 0==t)return!1;this.SlaveHostHostSelect=this.masterHostList[t].address,this.SlaveHostHostId=this.masterHostList[t].id,this.SlaveHostHostIndex=t,this.SlaveHostFixed=!1,this.createFixed=!0,console.log(this.SlaveHostHostSelect,this.SlaveHostHostId,this.SlaveHostHostIndex)},cancelSlaveHostHost:function(){this.SlaveHostFixed=!1,this.createFixed=!0,this.$refs.SlaveHostHostlookUp.selectIndex=this.SlaveHostHostIndex},putTestCase:function(){var t=this;if(this.$refs.CSTestCase.newCreate()){var e=this.$refs.CSTestCase.newCreate();e.ID=this.detailData.id,this.$q.loading.show(),i["K"](e).then((function(e){console.log(e),t.$q.notify({position:"top",message:"提示",caption:"保存成功",color:"secondary"}),t.$q.loading.hide()}))}},deleteTestCase:function(){var t=this;this.$q.dialog({title:"提示",message:"您确定要删除当前的测试用例吗",persistent:!0,ok:{push:!0,label:"确定"},cancel:{push:!0,label:"取消"}}).onOk((function(){t.$q.loading.show();var e="?id=".concat(t.detailData.id);i["f"](e).then((function(e){console.log(e),t.$router.push({name:"TestCase"})}))})).onCancel((function(){}))},openSlaveHost:function(){this.createFixed=!0},newCreate:function(){var t=this,e={HostID:this.SlaveHostHostId,TestCaseID:this.detailData.id,SlaveName:this.SlaveHostName,Count:Number(this.SlaveCount),ExtensionInfo:this.SlaveExtensionInfo};this.detailData.id&&this.SlaveHostName&&this.SlaveCount&&this.SlaveExtensionInfo&&this.SlaveHostHostId?(this.$q.loading.show(),i["C"](e).then((function(e){console.log(e),t.$q.notify({position:"top",message:"提示",caption:"创建成功",color:"secondary"}),t.newCancel(),t.getSlaveHostsList()}))):this.$q.notify({position:"top",message:"提示",caption:"请填写完整信息",color:"red"})},newCancel:function(){this.createFixed=!1,this.SlaveHostName="",this.SlaveCount="",this.SlaveExtensionInfo="",this.SlaveHostHostSelect="",this.SlaveHostHostId="",this.SlaveHostHostIndex=""},deleteSlaveHost:function(){var t=this;0!=this.SlaveHostSelected.length?this.$q.dialog({title:"提示",message:"您确定要删除当前选择的从主机吗",persistent:!0,ok:{push:!0,label:"确定"},cancel:{push:!0,label:"取消"}}).onOk((function(){if(t.$q.loading.show(),1==t.SlaveHostSelected.length){var e="?caseId=".concat(t.detailData.id,"&id=").concat(t.SlaveHostSelected[0].id);i["d"](e).then((function(e){console.log(e),t.SlaveHostSelected=[],t.getSlaveHostsList()}))}else if(t.SlaveHostSelected.length>1){for(var s=[],o=0;o<t.SlaveHostSelected.length;o++)s.push(t.SlaveHostSelected[o].id);console.log(s);var a={CaseID:t.detailData.id,IDS:s};i["e"](a).then((function(e){console.log(e),t.SlaveHostSelected=[],t.getSlaveHostsList()}))}})).onCancel((function(){})):this.$q.notify({position:"top",message:"提示",caption:"请选择从主机",color:"red"})},toSlaveHostDetail:function(t){console.log(t),sessionStorage.setItem("SlaveHostDetailData",JSON.stringify(t.row)),this.$router.push({name:"SlaveHostDetail"})},run:function(){var t=this;this.$q.loading.show();var e="?caseId=".concat(this.$route.query.id);i["G"](e).then((function(e){console.log(e),t.getTestCaseDetail(),t.$q.notify({position:"top",message:"提示",caption:"运行成功",color:"secondary"})}))},stop:function(){var t=this;this.$q.loading.show();var e="?caseId=".concat(this.$route.query.id);i["H"](e).then((function(e){console.log(e),t.getTestCaseDetail(),t.$q.notify({position:"top",message:"提示",caption:"停止成功",color:"secondary"})}))},lookStatus:function(){var t=this;this.$q.loading.show(),i["j"]({caseId:this.$route.query.id}).then((function(e){t.$q.dialog({title:"提示",message:e.data?"当前测试用例正在运行":"当前测试用例为停止状态"}),t.$q.loading.hide()}))},lookMasterLog:function(){var t=this;this.$q.loading.show(),i["o"]({caseId:this.$route.query.id}).then((function(e){t.$q.loading.hide(),t.$q.dialog({title:"提示",message:e.data,style:{width:"100%","max-width":"65vw","white-space":"pre-line","overflow-x":"hidden","word-break":"break-all"}})}))},lookSlaveLog:function(){var t=this;if(0==this.SlaveHostSelected.length)this.$q.notify({position:"top",message:"提示",caption:"请选择从主机",color:"red"});else if(1==this.SlaveHostSelected.length){this.$q.loading.show();var e={caseId:this.$route.query.id,slaveHostId:this.SlaveHostSelected[0].id};i["t"](e).then((function(e){t.$q.loading.hide(),t.$q.dialog({title:"提示",message:e.data,style:{width:"100%","max-width":"65vw","white-space":"pre-line","overflow-x":"hidden","word-break":"break-all"}})}))}else this.SlaveHostSelected.length>1&&this.$q.notify({position:"top",message:"提示",caption:"只能选择一个从主机",color:"red"})},lookMonitorUrl:function(){window.open(this.detailData.monitorUrl)}}},v=S,H=(s("d2d6"),s("c309"),Object(h["a"])(v,o,a,!1,null,"4fdce9e4",null));e["default"]=H.exports},5776:function(t,e,s){},6334:function(t,e,s){},c309:function(t,e,s){"use strict";var o=s("6334"),a=s.n(o);a.a},d2d6:function(t,e,s){"use strict";var o=s("5776"),a=s.n(o);a.a}}]);
//# sourceMappingURL=chunk-75f041a0.2eca4ba9.js.map